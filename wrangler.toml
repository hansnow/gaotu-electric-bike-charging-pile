name = "gaotu-electric-bike-charging-pile"
main = "worker.ts"
compatibility_date = "2024-01-01"
workers_dev = false

[observability]
enabled = true
head_sampling_rate = 1

[[routes]]
pattern = "electric-bike-charging-pile.hansnow.me"
custom_domain = true

[assets]
directory = "./public"
binding = "ASSETS"

[[kv_namespaces]]
binding = "CHARGING_EVENTS"
id = "be17b03b6713467f9114719918a4efb2"
preview_id = "7b26d5dbec2d4bb7996b0910d5487b78"

[[d1_databases]]
binding = "DB"
database_name = "gaotu-electric-bike-charging-pile-db"
database_id = "51413f16-745d-4cd4-9485-6182133e9af5"

[vars]
# 空闲提醒功能配置（可被数据库配置覆盖）
IDLE_ALERT_THRESHOLD_MINUTES = "30"
IDLE_ALERT_TIME_START = "08:00"
IDLE_ALERT_TIME_END = "17:00"
IDLE_ALERT_RETRY_TIMES = "2"
IDLE_ALERT_RETRY_INTERVAL = "60"
TIMEZONE = "Asia/Shanghai"

# 注意：敏感配置请使用 Secret 设置：
# wrangler secret put IDLE_ALERT_WEBHOOK_URLS
# wrangler secret put ADMIN_API_TOKEN

[triggers]
crons = ["* * * * *"]  # 每分钟执行一次（全天24小时）

# 生产环境配置 - 用于本地连接生产 KV
[env.production]
[[env.production.kv_namespaces]]
binding = "CHARGING_EVENTS"
id = "be17b03b6713467f9114719918a4efb2"
preview_id = "be17b03b6713467f9114719918a4efb2"
